{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"crypto-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":112},"end":{"line":4,"column":33,"index":145}}],"key":"TLjsXnAWOlf/gpObabse3HZX8VY=","exportNames":["*"],"imports":1}},{"name":"./keyDerivation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":146},"end":{"line":5,"column":54,"index":200}}],"key":"pLCGKbCUrckLcIDYaFZ/kr3WNgs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.hashPin = hashPin;\n  exports.verifyPin = verifyPin;\n  exports.generatePinSalt = generatePinSalt;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _cryptoJs = require(_dependencyMap[1], \"crypto-js\");\n  var CryptoJS = _interopDefault(_cryptoJs);\n  var _keyDerivation = require(_dependencyMap[2], \"./keyDerivation\");\n  // PIN Hashing Service - Zero Knowledge Vault\n  // PINs are hashed and salted locally, NEVER stored in plaintext\n\n  // Reduced iterations for faster PIN verification on mobile\n  var HASH_ITERATIONS = 5000;\n\n  /**\n   * Hash a PIN with salt using PBKDF2\n   * Returns the hash that can be stored locally for verification\n   */\n  function hashPin(pin, salt) {\n    var hash = CryptoJS.default.PBKDF2(pin, CryptoJS.default.enc.Hex.parse(salt), {\n      keySize: 256 / 32,\n      iterations: HASH_ITERATIONS,\n      hasher: CryptoJS.default.algo.SHA256\n    });\n    return hash.toString(CryptoJS.default.enc.Hex);\n  }\n\n  /**\n   * Verify a PIN against stored hash\n   */\n  function verifyPin(pin, salt, storedHash) {\n    var computedHash = hashPin(pin, salt);\n    // Constant-time comparison to prevent timing attacks\n    if (computedHash.length !== storedHash.length) return false;\n    var result = 0;\n    for (var i = 0; i < computedHash.length; i++) {\n      result |= computedHash.charCodeAt(i) ^ storedHash.charCodeAt(i);\n    }\n    return result === 0;\n  }\n\n  /**\n   * Generate a salt for PIN hashing\n   */\n  function generatePinSalt() {\n    return _generatePinSalt.apply(this, arguments);\n  }\n  function _generatePinSalt() {\n    _generatePinSalt = (0, _asyncToGenerator.default)(function* () {\n      return (0, _keyDerivation.generateRandomBytes)(16);\n    });\n    return _generatePinSalt.apply(this, arguments);\n  }\n});","lineCount":65,"map":[[12,2,14,0,"exports"],[12,9,14,0],[12,10,14,0,"hashPin"],[12,17,14,0],[12,20,14,0,"hashPin"],[12,27,14,0],[13,2,26,0,"exports"],[13,9,26,0],[13,10,26,0,"verifyPin"],[13,19,26,0],[13,22,26,0,"verifyPin"],[13,31,26,0],[14,2,40,0,"exports"],[14,9,40,0],[14,10,40,0,"generatePinSalt"],[14,25,40,0],[14,28,40,0,"generatePinSalt"],[14,43,40,0],[15,2,42,1],[15,6,42,1,"_babelRuntimeHelpersAsyncToGenerator"],[15,42,42,1],[15,45,42,1,"require"],[15,52,42,1],[15,53,42,1,"_dependencyMap"],[15,67,42,1],[16,2,42,1],[16,6,42,1,"_asyncToGenerator"],[16,23,42,1],[16,26,42,1,"_interopDefault"],[16,41,42,1],[16,42,42,1,"_babelRuntimeHelpersAsyncToGenerator"],[16,78,42,1],[17,2,4,0],[17,6,4,0,"_cryptoJs"],[17,15,4,0],[17,18,4,0,"require"],[17,25,4,0],[17,26,4,0,"_dependencyMap"],[17,40,4,0],[18,2,4,0],[18,6,4,0,"CryptoJS"],[18,14,4,0],[18,17,4,0,"_interopDefault"],[18,32,4,0],[18,33,4,0,"_cryptoJs"],[18,42,4,0],[19,2,5,0],[19,6,5,0,"_keyDerivation"],[19,20,5,0],[19,23,5,0,"require"],[19,30,5,0],[19,31,5,0,"_dependencyMap"],[19,45,5,0],[20,2,1,0],[21,2,2,0],[23,2,7,0],[24,2,8,0],[24,6,8,6,"HASH_ITERATIONS"],[24,21,8,21],[24,24,8,24],[24,28,8,28],[26,2,10,0],[27,0,11,0],[28,0,12,0],[29,0,13,0],[30,2,14,7],[30,11,14,16,"hashPin"],[30,18,14,23,"hashPin"],[30,19,14,24,"pin"],[30,22,14,35],[30,24,14,37,"salt"],[30,28,14,49],[30,30,14,59],[31,4,15,2],[31,8,15,8,"hash"],[31,12,15,12],[31,15,15,15,"CryptoJS"],[31,23,15,23],[31,24,15,23,"default"],[31,31,15,23],[31,32,15,24,"PBKDF2"],[31,38,15,30],[31,39,15,31,"pin"],[31,42,15,34],[31,44,15,36,"CryptoJS"],[31,52,15,44],[31,53,15,44,"default"],[31,60,15,44],[31,61,15,45,"enc"],[31,64,15,48],[31,65,15,49,"Hex"],[31,68,15,52],[31,69,15,53,"parse"],[31,74,15,58],[31,75,15,59,"salt"],[31,79,15,63],[31,80,15,64],[31,82,15,66],[32,6,16,4,"keySize"],[32,13,16,11],[32,15,16,13],[32,18,16,16],[32,21,16,19],[32,23,16,21],[33,6,17,4,"iterations"],[33,16,17,14],[33,18,17,16,"HASH_ITERATIONS"],[33,33,17,31],[34,6,18,4,"hasher"],[34,12,18,10],[34,14,18,12,"CryptoJS"],[34,22,18,20],[34,23,18,20,"default"],[34,30,18,20],[34,31,18,21,"algo"],[34,35,18,25],[34,36,18,26,"SHA256"],[35,4,19,2],[35,5,19,3],[35,6,19,4],[36,4,20,2],[36,11,20,9,"hash"],[36,15,20,13],[36,16,20,14,"toString"],[36,24,20,22],[36,25,20,23,"CryptoJS"],[36,33,20,31],[36,34,20,31,"default"],[36,41,20,31],[36,42,20,32,"enc"],[36,45,20,35],[36,46,20,36,"Hex"],[36,49,20,39],[36,50,20,40],[37,2,21,0],[39,2,23,0],[40,0,24,0],[41,0,25,0],[42,2,26,7],[42,11,26,16,"verifyPin"],[42,20,26,25,"verifyPin"],[42,21,26,26,"pin"],[42,24,26,37],[42,26,26,39,"salt"],[42,30,26,51],[42,32,26,53,"storedHash"],[42,42,26,71],[42,44,26,82],[43,4,27,2],[43,8,27,8,"computedHash"],[43,20,27,20],[43,23,27,23,"hashPin"],[43,30,27,30],[43,31,27,31,"pin"],[43,34,27,34],[43,36,27,36,"salt"],[43,40,27,40],[43,41,27,41],[44,4,28,2],[45,4,29,2],[45,8,29,6,"computedHash"],[45,20,29,18],[45,21,29,19,"length"],[45,27,29,25],[45,32,29,30,"storedHash"],[45,42,29,40],[45,43,29,41,"length"],[45,49,29,47],[45,51,29,49],[45,58,29,56],[45,63,29,61],[46,4,30,2],[46,8,30,6,"result"],[46,14,30,12],[46,17,30,15],[46,18,30,16],[47,4,31,2],[47,9,31,7],[47,13,31,11,"i"],[47,14,31,12],[47,17,31,15],[47,18,31,16],[47,20,31,18,"i"],[47,21,31,19],[47,24,31,22,"computedHash"],[47,36,31,34],[47,37,31,35,"length"],[47,43,31,41],[47,45,31,43,"i"],[47,46,31,44],[47,48,31,46],[47,50,31,48],[48,6,32,4,"result"],[48,12,32,10],[48,16,32,14,"computedHash"],[48,28,32,26],[48,29,32,27,"charCodeAt"],[48,39,32,37],[48,40,32,38,"i"],[48,41,32,39],[48,42,32,40],[48,45,32,43,"storedHash"],[48,55,32,53],[48,56,32,54,"charCodeAt"],[48,66,32,64],[48,67,32,65,"i"],[48,68,32,66],[48,69,32,67],[49,4,33,2],[50,4,34,2],[50,11,34,9,"result"],[50,17,34,15],[50,22,34,20],[50,23,34,21],[51,2,35,0],[53,2,37,0],[54,0,38,0],[55,0,39,0],[56,2,37,0],[56,11,40,22,"generatePinSalt"],[56,26,40,37,"generatePinSalt"],[56,27,40,37],[57,4,40,37],[57,11,40,37,"_generatePinSalt"],[57,27,40,37],[57,28,40,37,"apply"],[57,33,40,37],[57,40,40,37,"arguments"],[57,49,40,37],[58,2,40,37],[59,2,40,37],[59,11,40,37,"_generatePinSalt"],[59,28,40,37],[60,4,40,37,"_generatePinSalt"],[60,20,40,37],[60,27,40,37,"_asyncToGenerator"],[60,44,40,37],[60,45,40,37,"default"],[60,52,40,37],[60,54,40,7],[60,67,40,57],[61,6,41,2],[61,13,41,9],[61,17,41,9,"generateRandomBytes"],[61,31,41,28],[61,32,41,28,"generateRandomBytes"],[61,51,41,28],[61,53,41,29],[61,55,41,31],[61,56,41,32],[62,4,42,0],[62,5,42,1],[63,4,42,1],[63,11,42,1,"_generatePinSalt"],[63,27,42,1],[63,28,42,1,"apply"],[63,33,42,1],[63,40,42,1,"arguments"],[63,49,42,1],[64,2,42,1],[65,0,42,1],[65,3]],"functionMap":{"names":["<global>","hashPin","verifyPin","generatePinSalt"],"mappings":"AAA;OCa;CDO;OEK;CFS;OGK;CHE"},"hasCjsExports":false},"type":"js/module"}]}