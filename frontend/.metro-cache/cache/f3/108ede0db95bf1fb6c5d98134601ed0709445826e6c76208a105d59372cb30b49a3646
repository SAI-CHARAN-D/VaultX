{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"crypto-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":107},"end":{"line":4,"column":33,"index":140}}],"key":"TLjsXnAWOlf/gpObabse3HZX8VY=","exportNames":["*"],"imports":1}},{"name":"expo-crypto","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":141},"end":{"line":5,"column":42,"index":183}}],"key":"+Akla+LrhuGGU54C9zXxLPlFUv4=","exportNames":["*"],"imports":1}},{"name":"buffer","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":184},"end":{"line":6,"column":32,"index":216}}],"key":"L2R9OUI0/cSYwzijo34ce4VujKY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.generateRandomBytes = generateRandomBytes;\n  exports.deriveMasterKey = deriveMasterKey;\n  exports.generateSalt = generateSalt;\n  exports.generateFEK = generateFEK;\n  exports.generateIV = generateIV;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _cryptoJs = require(_dependencyMap[1], \"crypto-js\");\n  var CryptoJS = _interopDefault(_cryptoJs);\n  var _expoCrypto = require(_dependencyMap[2], \"expo-crypto\");\n  var ExpoRandom = _interopNamespace(_expoCrypto);\n  var _buffer = require(_dependencyMap[3], \"buffer\");\n  // PBKDF2 Key Derivation - Zero Knowledge Vault\n  // Master Key is NEVER stored, always re-derived from PIN\n\n  global.Buffer = global.Buffer || _buffer.Buffer;\n\n  // Reduced iterations for mobile performance (still secure but faster)\n  // 10,000 iterations provides good security while being responsive on mobile\n  var ITERATIONS = 10000;\n  var KEY_SIZE = 256 / 32; // 256 bits = 8 words (32 bits each)\n  var SALT_SIZE = 16; // 16 bytes = 128 bits\n\n  /**\n   * Generate cryptographically secure random bytes\n   */\n  function generateRandomBytes(_x) {\n    return _generateRandomBytes.apply(this, arguments);\n  }\n  /**\n   * Derive master key from PIN using PBKDF2-HMAC-SHA256\n   * Key is 256 bits, never stored, re-derived on every unlock\n   */\n  function _generateRandomBytes() {\n    _generateRandomBytes = (0, _asyncToGenerator.default)(function* (size) {\n      try {\n        var randomBytes = yield ExpoRandom.getRandomBytesAsync(size);\n        return _buffer.Buffer.from(randomBytes).toString('hex');\n      } catch (error) {\n        // Fallback for web\n        var array = new Uint8Array(size);\n        if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n          crypto.getRandomValues(array);\n        } else {\n          for (var i = 0; i < size; i++) {\n            array[i] = Math.floor(Math.random() * 256);\n          }\n        }\n        return _buffer.Buffer.from(array).toString('hex');\n      }\n    });\n    return _generateRandomBytes.apply(this, arguments);\n  }\n  function deriveMasterKey(pin, salt) {\n    var key = CryptoJS.default.PBKDF2(pin, CryptoJS.default.enc.Hex.parse(salt), {\n      keySize: KEY_SIZE,\n      iterations: ITERATIONS,\n      hasher: CryptoJS.default.algo.SHA256\n    });\n    return key.toString(CryptoJS.default.enc.Hex);\n  }\n\n  /**\n   * Generate a new salt for key derivation\n   */\n  function generateSalt() {\n    return _generateSalt.apply(this, arguments);\n  }\n  /**\n   * Generate a random File Encryption Key (FEK) for each document\n   */\n  function _generateSalt() {\n    _generateSalt = (0, _asyncToGenerator.default)(function* () {\n      return generateRandomBytes(SALT_SIZE);\n    });\n    return _generateSalt.apply(this, arguments);\n  }\n  function generateFEK() {\n    return _generateFEK.apply(this, arguments);\n  }\n  /**\n   * Generate initialization vector for AES-GCM\n   */\n  function _generateFEK() {\n    _generateFEK = (0, _asyncToGenerator.default)(function* () {\n      return generateRandomBytes(32); // 256 bits\n    });\n    return _generateFEK.apply(this, arguments);\n  }\n  function generateIV() {\n    return _generateIV.apply(this, arguments);\n  }\n  function _generateIV() {\n    _generateIV = (0, _asyncToGenerator.default)(function* () {\n      return generateRandomBytes(12); // 96 bits for GCM\n    });\n    return _generateIV.apply(this, arguments);\n  }\n});","lineCount":125,"map":[[27,2,19,0,"exports"],[27,9,19,0],[27,10,19,0,"generateRandomBytes"],[27,29,19,0],[27,32,19,0,"generateRandomBytes"],[27,51,19,0],[28,2,41,0,"exports"],[28,9,41,0],[28,10,41,0,"deriveMasterKey"],[28,25,41,0],[28,28,41,0,"deriveMasterKey"],[28,43,41,0],[29,2,53,0,"exports"],[29,9,53,0],[29,10,53,0,"generateSalt"],[29,22,53,0],[29,25,53,0,"generateSalt"],[29,37,53,0],[30,2,60,0,"exports"],[30,9,60,0],[30,10,60,0,"generateFEK"],[30,21,60,0],[30,24,60,0,"generateFEK"],[30,35,60,0],[31,2,67,0,"exports"],[31,9,67,0],[31,10,67,0,"generateIV"],[31,20,67,0],[31,23,67,0,"generateIV"],[31,33,67,0],[32,2,69,1],[32,6,69,1,"_babelRuntimeHelpersAsyncToGenerator"],[32,42,69,1],[32,45,69,1,"require"],[32,52,69,1],[32,53,69,1,"_dependencyMap"],[32,67,69,1],[33,2,69,1],[33,6,69,1,"_asyncToGenerator"],[33,23,69,1],[33,26,69,1,"_interopDefault"],[33,41,69,1],[33,42,69,1,"_babelRuntimeHelpersAsyncToGenerator"],[33,78,69,1],[34,2,4,0],[34,6,4,0,"_cryptoJs"],[34,15,4,0],[34,18,4,0,"require"],[34,25,4,0],[34,26,4,0,"_dependencyMap"],[34,40,4,0],[35,2,4,0],[35,6,4,0,"CryptoJS"],[35,14,4,0],[35,17,4,0,"_interopDefault"],[35,32,4,0],[35,33,4,0,"_cryptoJs"],[35,42,4,0],[36,2,5,0],[36,6,5,0,"_expoCrypto"],[36,17,5,0],[36,20,5,0,"require"],[36,27,5,0],[36,28,5,0,"_dependencyMap"],[36,42,5,0],[37,2,5,0],[37,6,5,0,"ExpoRandom"],[37,16,5,0],[37,19,5,0,"_interopNamespace"],[37,36,5,0],[37,37,5,0,"_expoCrypto"],[37,48,5,0],[38,2,6,0],[38,6,6,0,"_buffer"],[38,13,6,0],[38,16,6,0,"require"],[38,23,6,0],[38,24,6,0,"_dependencyMap"],[38,38,6,0],[39,2,1,0],[40,2,2,0],[42,2,8,0,"global"],[42,8,8,6],[42,9,8,7,"Buffer"],[42,15,8,13],[42,18,8,16,"global"],[42,24,8,22],[42,25,8,23,"Buffer"],[42,31,8,29],[42,35,8,33,"Buffer"],[42,42,8,39],[42,43,8,39,"Buffer"],[42,49,8,39],[44,2,10,0],[45,2,11,0],[46,2,12,0],[46,6,12,6,"ITERATIONS"],[46,16,12,16],[46,19,12,19],[46,24,12,24],[47,2,13,0],[47,6,13,6,"KEY_SIZE"],[47,14,13,14],[47,17,13,17],[47,20,13,20],[47,23,13,23],[47,25,13,25],[47,26,13,26],[47,27,13,27],[48,2,14,0],[48,6,14,6,"SALT_SIZE"],[48,15,14,15],[48,18,14,18],[48,20,14,20],[48,21,14,21],[48,22,14,22],[50,2,16,0],[51,0,17,0],[52,0,18,0],[53,2,16,0],[53,11,19,22,"generateRandomBytes"],[53,30,19,41,"generateRandomBytes"],[53,31,19,41,"_x"],[53,33,19,41],[54,4,19,41],[54,11,19,41,"_generateRandomBytes"],[54,31,19,41],[54,32,19,41,"apply"],[54,37,19,41],[54,44,19,41,"arguments"],[54,53,19,41],[55,2,19,41],[56,2,37,0],[57,0,38,0],[58,0,39,0],[59,0,40,0],[60,2,37,0],[60,11,37,0,"_generateRandomBytes"],[60,32,37,0],[61,4,37,0,"_generateRandomBytes"],[61,24,37,0],[61,31,37,0,"_asyncToGenerator"],[61,48,37,0],[61,49,37,0,"default"],[61,56,37,0],[61,58,19,7],[61,69,19,42,"size"],[61,73,19,54],[61,75,19,73],[62,6,20,2],[62,10,20,6],[63,8,21,4],[63,12,21,10,"randomBytes"],[63,23,21,21],[63,32,21,30,"ExpoRandom"],[63,42,21,40],[63,43,21,41,"getRandomBytesAsync"],[63,62,21,60],[63,63,21,61,"size"],[63,67,21,65],[63,68,21,66],[64,8,22,4],[64,15,22,11,"Buffer"],[64,22,22,17],[64,23,22,17,"Buffer"],[64,29,22,17],[64,30,22,18,"from"],[64,34,22,22],[64,35,22,23,"randomBytes"],[64,46,22,34],[64,47,22,35],[64,48,22,36,"toString"],[64,56,22,44],[64,57,22,45],[64,62,22,50],[64,63,22,51],[65,6,23,2],[65,7,23,3],[65,8,23,4],[65,15,23,11,"error"],[65,20,23,16],[65,22,23,18],[66,8,24,4],[67,8,25,4],[67,12,25,10,"array"],[67,17,25,15],[67,20,25,18],[67,24,25,22,"Uint8Array"],[67,34,25,32],[67,35,25,33,"size"],[67,39,25,37],[67,40,25,38],[68,8,26,4],[68,12,26,8],[68,19,26,15,"crypto"],[68,25,26,21],[68,30,26,26],[68,41,26,37],[68,45,26,41,"crypto"],[68,51,26,47],[68,52,26,48,"getRandomValues"],[68,67,26,63],[68,69,26,65],[69,10,27,6,"crypto"],[69,16,27,12],[69,17,27,13,"getRandomValues"],[69,32,27,28],[69,33,27,29,"array"],[69,38,27,34],[69,39,27,35],[70,8,28,4],[70,9,28,5],[70,15,28,11],[71,10,29,6],[71,15,29,11],[71,19,29,15,"i"],[71,20,29,16],[71,23,29,19],[71,24,29,20],[71,26,29,22,"i"],[71,27,29,23],[71,30,29,26,"size"],[71,34,29,30],[71,36,29,32,"i"],[71,37,29,33],[71,39,29,35],[71,41,29,37],[72,12,30,8,"array"],[72,17,30,13],[72,18,30,14,"i"],[72,19,30,15],[72,20,30,16],[72,23,30,19,"Math"],[72,27,30,23],[72,28,30,24,"floor"],[72,33,30,29],[72,34,30,30,"Math"],[72,38,30,34],[72,39,30,35,"random"],[72,45,30,41],[72,46,30,42],[72,47,30,43],[72,50,30,46],[72,53,30,49],[72,54,30,50],[73,10,31,6],[74,8,32,4],[75,8,33,4],[75,15,33,11,"Buffer"],[75,22,33,17],[75,23,33,17,"Buffer"],[75,29,33,17],[75,30,33,18,"from"],[75,34,33,22],[75,35,33,23,"array"],[75,40,33,28],[75,41,33,29],[75,42,33,30,"toString"],[75,50,33,38],[75,51,33,39],[75,56,33,44],[75,57,33,45],[76,6,34,2],[77,4,35,0],[77,5,35,1],[78,4,35,1],[78,11,35,1,"_generateRandomBytes"],[78,31,35,1],[78,32,35,1,"apply"],[78,37,35,1],[78,44,35,1,"arguments"],[78,53,35,1],[79,2,35,1],[80,2,41,7],[80,11,41,16,"deriveMasterKey"],[80,26,41,31,"deriveMasterKey"],[80,27,41,32,"pin"],[80,30,41,43],[80,32,41,45,"salt"],[80,36,41,57],[80,38,41,67],[81,4,42,2],[81,8,42,8,"key"],[81,11,42,11],[81,14,42,14,"CryptoJS"],[81,22,42,22],[81,23,42,22,"default"],[81,30,42,22],[81,31,42,23,"PBKDF2"],[81,37,42,29],[81,38,42,30,"pin"],[81,41,42,33],[81,43,42,35,"CryptoJS"],[81,51,42,43],[81,52,42,43,"default"],[81,59,42,43],[81,60,42,44,"enc"],[81,63,42,47],[81,64,42,48,"Hex"],[81,67,42,51],[81,68,42,52,"parse"],[81,73,42,57],[81,74,42,58,"salt"],[81,78,42,62],[81,79,42,63],[81,81,42,65],[82,6,43,4,"keySize"],[82,13,43,11],[82,15,43,13,"KEY_SIZE"],[82,23,43,21],[83,6,44,4,"iterations"],[83,16,44,14],[83,18,44,16,"ITERATIONS"],[83,28,44,26],[84,6,45,4,"hasher"],[84,12,45,10],[84,14,45,12,"CryptoJS"],[84,22,45,20],[84,23,45,20,"default"],[84,30,45,20],[84,31,45,21,"algo"],[84,35,45,25],[84,36,45,26,"SHA256"],[85,4,46,2],[85,5,46,3],[85,6,46,4],[86,4,47,2],[86,11,47,9,"key"],[86,14,47,12],[86,15,47,13,"toString"],[86,23,47,21],[86,24,47,22,"CryptoJS"],[86,32,47,30],[86,33,47,30,"default"],[86,40,47,30],[86,41,47,31,"enc"],[86,44,47,34],[86,45,47,35,"Hex"],[86,48,47,38],[86,49,47,39],[87,2,48,0],[89,2,50,0],[90,0,51,0],[91,0,52,0],[92,2,50,0],[92,11,53,22,"generateSalt"],[92,23,53,34,"generateSalt"],[92,24,53,34],[93,4,53,34],[93,11,53,34,"_generateSalt"],[93,24,53,34],[93,25,53,34,"apply"],[93,30,53,34],[93,37,53,34,"arguments"],[93,46,53,34],[94,2,53,34],[95,2,57,0],[96,0,58,0],[97,0,59,0],[98,2,57,0],[98,11,57,0,"_generateSalt"],[98,25,57,0],[99,4,57,0,"_generateSalt"],[99,17,57,0],[99,24,57,0,"_asyncToGenerator"],[99,41,57,0],[99,42,57,0,"default"],[99,49,57,0],[99,51,53,7],[99,64,53,54],[100,6,54,2],[100,13,54,9,"generateRandomBytes"],[100,32,54,28],[100,33,54,29,"SALT_SIZE"],[100,42,54,38],[100,43,54,39],[101,4,55,0],[101,5,55,1],[102,4,55,1],[102,11,55,1,"_generateSalt"],[102,24,55,1],[102,25,55,1,"apply"],[102,30,55,1],[102,37,55,1,"arguments"],[102,46,55,1],[103,2,55,1],[104,2,55,1],[104,11,60,22,"generateFEK"],[104,22,60,33,"generateFEK"],[104,23,60,33],[105,4,60,33],[105,11,60,33,"_generateFEK"],[105,23,60,33],[105,24,60,33,"apply"],[105,29,60,33],[105,36,60,33,"arguments"],[105,45,60,33],[106,2,60,33],[107,2,64,0],[108,0,65,0],[109,0,66,0],[110,2,64,0],[110,11,64,0,"_generateFEK"],[110,24,64,0],[111,4,64,0,"_generateFEK"],[111,16,64,0],[111,23,64,0,"_asyncToGenerator"],[111,40,64,0],[111,41,64,0,"default"],[111,48,64,0],[111,50,60,7],[111,63,60,53],[112,6,61,2],[112,13,61,9,"generateRandomBytes"],[112,32,61,28],[112,33,61,29],[112,35,61,31],[112,36,61,32],[112,37,61,33],[112,38,61,34],[113,4,62,0],[113,5,62,1],[114,4,62,1],[114,11,62,1,"_generateFEK"],[114,23,62,1],[114,24,62,1,"apply"],[114,29,62,1],[114,36,62,1,"arguments"],[114,45,62,1],[115,2,62,1],[116,2,62,1],[116,11,67,22,"generateIV"],[116,21,67,32,"generateIV"],[116,22,67,32],[117,4,67,32],[117,11,67,32,"_generateIV"],[117,22,67,32],[117,23,67,32,"apply"],[117,28,67,32],[117,35,67,32,"arguments"],[117,44,67,32],[118,2,67,32],[119,2,67,32],[119,11,67,32,"_generateIV"],[119,23,67,32],[120,4,67,32,"_generateIV"],[120,15,67,32],[120,22,67,32,"_asyncToGenerator"],[120,39,67,32],[120,40,67,32,"default"],[120,47,67,32],[120,49,67,7],[120,62,67,52],[121,6,68,2],[121,13,68,9,"generateRandomBytes"],[121,32,68,28],[121,33,68,29],[121,35,68,31],[121,36,68,32],[121,37,68,33],[121,38,68,34],[122,4,69,0],[122,5,69,1],[123,4,69,1],[123,11,69,1,"_generateIV"],[123,22,69,1],[123,23,69,1,"apply"],[123,28,69,1],[123,35,69,1,"arguments"],[123,44,69,1],[124,2,69,1],[125,0,69,1],[125,3]],"functionMap":{"names":["<global>","generateRandomBytes","deriveMasterKey","generateSalt","generateFEK","generateIV"],"mappings":"AAA;OCkB;CDgB;OEM;CFO;OGK;CHE;OIK;CJE;OKK;CLE"},"hasCjsExports":false},"type":"js/module"}]}