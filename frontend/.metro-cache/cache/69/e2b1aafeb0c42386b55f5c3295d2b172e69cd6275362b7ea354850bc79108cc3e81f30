{"dependencies":[{"name":"crypto-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":112},"end":{"line":4,"column":33,"index":145}}],"key":"TLjsXnAWOlf/gpObabse3HZX8VY=","exportNames":["*"],"imports":1}},{"name":"./keyDerivation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":146},"end":{"line":5,"column":54,"index":200}}],"key":"pLCGKbCUrckLcIDYaFZ/kr3WNgs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.hashPin = hashPin;\n  exports.verifyPin = verifyPin;\n  exports.generatePinSalt = generatePinSalt;\n  var _cryptoJs = require(_dependencyMap[0], \"crypto-js\");\n  var CryptoJS = _interopDefault(_cryptoJs);\n  var _keyDerivation = require(_dependencyMap[1], \"./keyDerivation\");\n  // PIN Hashing Service - Zero Knowledge Vault\n  // PINs are hashed and salted locally, NEVER stored in plaintext\n\n  // Reduced iterations for faster PIN verification on mobile\n  const HASH_ITERATIONS = 5000;\n\n  /**\n   * Hash a PIN with salt using PBKDF2\n   * Returns the hash that can be stored locally for verification\n   */\n  function hashPin(pin, salt) {\n    const hash = CryptoJS.default.PBKDF2(pin, CryptoJS.default.enc.Hex.parse(salt), {\n      keySize: 256 / 32,\n      iterations: HASH_ITERATIONS,\n      hasher: CryptoJS.default.algo.SHA256\n    });\n    return hash.toString(CryptoJS.default.enc.Hex);\n  }\n\n  /**\n   * Verify a PIN against stored hash\n   */\n  function verifyPin(pin, salt, storedHash) {\n    const computedHash = hashPin(pin, salt);\n    // Constant-time comparison to prevent timing attacks\n    if (computedHash.length !== storedHash.length) return false;\n    let result = 0;\n    for (let i = 0; i < computedHash.length; i++) {\n      result |= computedHash.charCodeAt(i) ^ storedHash.charCodeAt(i);\n    }\n    return result === 0;\n  }\n\n  /**\n   * Generate a salt for PIN hashing\n   */\n  async function generatePinSalt() {\n    return (0, _keyDerivation.generateRandomBytes)(16);\n  }\n});","lineCount":57,"map":[[12,2,14,0,"exports"],[12,9,14,0],[12,10,14,0,"hashPin"],[12,17,14,0],[12,20,14,0,"hashPin"],[12,27,14,0],[13,2,26,0,"exports"],[13,9,26,0],[13,10,26,0,"verifyPin"],[13,19,26,0],[13,22,26,0,"verifyPin"],[13,31,26,0],[14,2,40,0,"exports"],[14,9,40,0],[14,10,40,0,"generatePinSalt"],[14,25,40,0],[14,28,40,0,"generatePinSalt"],[14,43,40,0],[15,2,4,0],[15,6,4,0,"_cryptoJs"],[15,15,4,0],[15,18,4,0,"require"],[15,25,4,0],[15,26,4,0,"_dependencyMap"],[15,40,4,0],[16,2,4,0],[16,6,4,0,"CryptoJS"],[16,14,4,0],[16,17,4,0,"_interopDefault"],[16,32,4,0],[16,33,4,0,"_cryptoJs"],[16,42,4,0],[17,2,5,0],[17,6,5,0,"_keyDerivation"],[17,20,5,0],[17,23,5,0,"require"],[17,30,5,0],[17,31,5,0,"_dependencyMap"],[17,45,5,0],[18,2,1,0],[19,2,2,0],[21,2,7,0],[22,2,8,0],[22,8,8,6,"HASH_ITERATIONS"],[22,23,8,21],[22,26,8,24],[22,30,8,28],[24,2,10,0],[25,0,11,0],[26,0,12,0],[27,0,13,0],[28,2,14,7],[28,11,14,16,"hashPin"],[28,18,14,23,"hashPin"],[28,19,14,24,"pin"],[28,22,14,35],[28,24,14,37,"salt"],[28,28,14,49],[28,30,14,59],[29,4,15,2],[29,10,15,8,"hash"],[29,14,15,12],[29,17,15,15,"CryptoJS"],[29,25,15,23],[29,26,15,23,"default"],[29,33,15,23],[29,34,15,24,"PBKDF2"],[29,40,15,30],[29,41,15,31,"pin"],[29,44,15,34],[29,46,15,36,"CryptoJS"],[29,54,15,44],[29,55,15,44,"default"],[29,62,15,44],[29,63,15,45,"enc"],[29,66,15,48],[29,67,15,49,"Hex"],[29,70,15,52],[29,71,15,53,"parse"],[29,76,15,58],[29,77,15,59,"salt"],[29,81,15,63],[29,82,15,64],[29,84,15,66],[30,6,16,4,"keySize"],[30,13,16,11],[30,15,16,13],[30,18,16,16],[30,21,16,19],[30,23,16,21],[31,6,17,4,"iterations"],[31,16,17,14],[31,18,17,16,"HASH_ITERATIONS"],[31,33,17,31],[32,6,18,4,"hasher"],[32,12,18,10],[32,14,18,12,"CryptoJS"],[32,22,18,20],[32,23,18,20,"default"],[32,30,18,20],[32,31,18,21,"algo"],[32,35,18,25],[32,36,18,26,"SHA256"],[33,4,19,2],[33,5,19,3],[33,6,19,4],[34,4,20,2],[34,11,20,9,"hash"],[34,15,20,13],[34,16,20,14,"toString"],[34,24,20,22],[34,25,20,23,"CryptoJS"],[34,33,20,31],[34,34,20,31,"default"],[34,41,20,31],[34,42,20,32,"enc"],[34,45,20,35],[34,46,20,36,"Hex"],[34,49,20,39],[34,50,20,40],[35,2,21,0],[37,2,23,0],[38,0,24,0],[39,0,25,0],[40,2,26,7],[40,11,26,16,"verifyPin"],[40,20,26,25,"verifyPin"],[40,21,26,26,"pin"],[40,24,26,37],[40,26,26,39,"salt"],[40,30,26,51],[40,32,26,53,"storedHash"],[40,42,26,71],[40,44,26,82],[41,4,27,2],[41,10,27,8,"computedHash"],[41,22,27,20],[41,25,27,23,"hashPin"],[41,32,27,30],[41,33,27,31,"pin"],[41,36,27,34],[41,38,27,36,"salt"],[41,42,27,40],[41,43,27,41],[42,4,28,2],[43,4,29,2],[43,8,29,6,"computedHash"],[43,20,29,18],[43,21,29,19,"length"],[43,27,29,25],[43,32,29,30,"storedHash"],[43,42,29,40],[43,43,29,41,"length"],[43,49,29,47],[43,51,29,49],[43,58,29,56],[43,63,29,61],[44,4,30,2],[44,8,30,6,"result"],[44,14,30,12],[44,17,30,15],[44,18,30,16],[45,4,31,2],[45,9,31,7],[45,13,31,11,"i"],[45,14,31,12],[45,17,31,15],[45,18,31,16],[45,20,31,18,"i"],[45,21,31,19],[45,24,31,22,"computedHash"],[45,36,31,34],[45,37,31,35,"length"],[45,43,31,41],[45,45,31,43,"i"],[45,46,31,44],[45,48,31,46],[45,50,31,48],[46,6,32,4,"result"],[46,12,32,10],[46,16,32,14,"computedHash"],[46,28,32,26],[46,29,32,27,"charCodeAt"],[46,39,32,37],[46,40,32,38,"i"],[46,41,32,39],[46,42,32,40],[46,45,32,43,"storedHash"],[46,55,32,53],[46,56,32,54,"charCodeAt"],[46,66,32,64],[46,67,32,65,"i"],[46,68,32,66],[46,69,32,67],[47,4,33,2],[48,4,34,2],[48,11,34,9,"result"],[48,17,34,15],[48,22,34,20],[48,23,34,21],[49,2,35,0],[51,2,37,0],[52,0,38,0],[53,0,39,0],[54,2,40,7],[54,17,40,22,"generatePinSalt"],[54,32,40,37,"generatePinSalt"],[54,33,40,37],[54,35,40,57],[55,4,41,2],[55,11,41,9],[55,15,41,9,"generateRandomBytes"],[55,29,41,28],[55,30,41,28,"generateRandomBytes"],[55,49,41,28],[55,51,41,29],[55,53,41,31],[55,54,41,32],[56,2,42,0],[57,0,42,1],[57,3]],"functionMap":{"names":["<global>","hashPin","verifyPin","generatePinSalt"],"mappings":"AAA;OCa;CDO;OEK;CFS;OGK;CHE"},"hasCjsExports":false},"type":"js/module"}]}