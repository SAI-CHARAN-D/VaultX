{"dependencies":[{"name":"crypto-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":107},"end":{"line":4,"column":33,"index":140}}],"key":"TLjsXnAWOlf/gpObabse3HZX8VY=","exportNames":["*"],"imports":1}},{"name":"expo-crypto","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":141},"end":{"line":5,"column":42,"index":183}}],"key":"+Akla+LrhuGGU54C9zXxLPlFUv4=","exportNames":["*"],"imports":1}},{"name":"buffer","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":184},"end":{"line":6,"column":32,"index":216}}],"key":"L2R9OUI0/cSYwzijo34ce4VujKY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.generateRandomBytes = generateRandomBytes;\n  exports.deriveMasterKey = deriveMasterKey;\n  exports.generateSalt = generateSalt;\n  exports.generateFEK = generateFEK;\n  exports.generateIV = generateIV;\n  var _cryptoJs = require(_dependencyMap[0], \"crypto-js\");\n  var CryptoJS = _interopDefault(_cryptoJs);\n  var _expoCrypto = require(_dependencyMap[1], \"expo-crypto\");\n  var ExpoRandom = _interopNamespace(_expoCrypto);\n  var _buffer = require(_dependencyMap[2], \"buffer\");\n  // PBKDF2 Key Derivation - Zero Knowledge Vault\n  // Master Key is NEVER stored, always re-derived from PIN\n\n  global.Buffer = global.Buffer || _buffer.Buffer;\n\n  // Reduced iterations for mobile performance (still secure but faster)\n  // 10,000 iterations provides good security while being responsive on mobile\n  const ITERATIONS = 10000;\n  const KEY_SIZE = 256 / 32; // 256 bits = 8 words (32 bits each)\n  const SALT_SIZE = 16; // 16 bytes = 128 bits\n\n  /**\n   * Generate cryptographically secure random bytes\n   */\n  async function generateRandomBytes(size) {\n    try {\n      const randomBytes = await ExpoRandom.getRandomBytesAsync(size);\n      return _buffer.Buffer.from(randomBytes).toString('hex');\n    } catch (error) {\n      // Fallback for web\n      const array = new Uint8Array(size);\n      if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n        crypto.getRandomValues(array);\n      } else {\n        for (let i = 0; i < size; i++) {\n          array[i] = Math.floor(Math.random() * 256);\n        }\n      }\n      return _buffer.Buffer.from(array).toString('hex');\n    }\n  }\n\n  /**\n   * Derive master key from PIN using PBKDF2-HMAC-SHA256\n   * Key is 256 bits, never stored, re-derived on every unlock\n   */\n  function deriveMasterKey(pin, salt) {\n    const key = CryptoJS.default.PBKDF2(pin, CryptoJS.default.enc.Hex.parse(salt), {\n      keySize: KEY_SIZE,\n      iterations: ITERATIONS,\n      hasher: CryptoJS.default.algo.SHA256\n    });\n    return key.toString(CryptoJS.default.enc.Hex);\n  }\n\n  /**\n   * Generate a new salt for key derivation\n   */\n  async function generateSalt() {\n    return generateRandomBytes(SALT_SIZE);\n  }\n\n  /**\n   * Generate a random File Encryption Key (FEK) for each document\n   */\n  async function generateFEK() {\n    return generateRandomBytes(32); // 256 bits\n  }\n\n  /**\n   * Generate initialization vector for AES-GCM\n   */\n  async function generateIV() {\n    return generateRandomBytes(12); // 96 bits for GCM\n  }\n});","lineCount":102,"map":[[27,2,19,0,"exports"],[27,9,19,0],[27,10,19,0,"generateRandomBytes"],[27,29,19,0],[27,32,19,0,"generateRandomBytes"],[27,51,19,0],[28,2,41,0,"exports"],[28,9,41,0],[28,10,41,0,"deriveMasterKey"],[28,25,41,0],[28,28,41,0,"deriveMasterKey"],[28,43,41,0],[29,2,53,0,"exports"],[29,9,53,0],[29,10,53,0,"generateSalt"],[29,22,53,0],[29,25,53,0,"generateSalt"],[29,37,53,0],[30,2,60,0,"exports"],[30,9,60,0],[30,10,60,0,"generateFEK"],[30,21,60,0],[30,24,60,0,"generateFEK"],[30,35,60,0],[31,2,67,0,"exports"],[31,9,67,0],[31,10,67,0,"generateIV"],[31,20,67,0],[31,23,67,0,"generateIV"],[31,33,67,0],[32,2,4,0],[32,6,4,0,"_cryptoJs"],[32,15,4,0],[32,18,4,0,"require"],[32,25,4,0],[32,26,4,0,"_dependencyMap"],[32,40,4,0],[33,2,4,0],[33,6,4,0,"CryptoJS"],[33,14,4,0],[33,17,4,0,"_interopDefault"],[33,32,4,0],[33,33,4,0,"_cryptoJs"],[33,42,4,0],[34,2,5,0],[34,6,5,0,"_expoCrypto"],[34,17,5,0],[34,20,5,0,"require"],[34,27,5,0],[34,28,5,0,"_dependencyMap"],[34,42,5,0],[35,2,5,0],[35,6,5,0,"ExpoRandom"],[35,16,5,0],[35,19,5,0,"_interopNamespace"],[35,36,5,0],[35,37,5,0,"_expoCrypto"],[35,48,5,0],[36,2,6,0],[36,6,6,0,"_buffer"],[36,13,6,0],[36,16,6,0,"require"],[36,23,6,0],[36,24,6,0,"_dependencyMap"],[36,38,6,0],[37,2,1,0],[38,2,2,0],[40,2,8,0,"global"],[40,8,8,6],[40,9,8,7,"Buffer"],[40,15,8,13],[40,18,8,16,"global"],[40,24,8,22],[40,25,8,23,"Buffer"],[40,31,8,29],[40,35,8,33,"Buffer"],[40,42,8,39],[40,43,8,39,"Buffer"],[40,49,8,39],[42,2,10,0],[43,2,11,0],[44,2,12,0],[44,8,12,6,"ITERATIONS"],[44,18,12,16],[44,21,12,19],[44,26,12,24],[45,2,13,0],[45,8,13,6,"KEY_SIZE"],[45,16,13,14],[45,19,13,17],[45,22,13,20],[45,25,13,23],[45,27,13,25],[45,28,13,26],[45,29,13,27],[46,2,14,0],[46,8,14,6,"SALT_SIZE"],[46,17,14,15],[46,20,14,18],[46,22,14,20],[46,23,14,21],[46,24,14,22],[48,2,16,0],[49,0,17,0],[50,0,18,0],[51,2,19,7],[51,17,19,22,"generateRandomBytes"],[51,36,19,41,"generateRandomBytes"],[51,37,19,42,"size"],[51,41,19,54],[51,43,19,73],[52,4,20,2],[52,8,20,6],[53,6,21,4],[53,12,21,10,"randomBytes"],[53,23,21,21],[53,26,21,24],[53,32,21,30,"ExpoRandom"],[53,42,21,40],[53,43,21,41,"getRandomBytesAsync"],[53,62,21,60],[53,63,21,61,"size"],[53,67,21,65],[53,68,21,66],[54,6,22,4],[54,13,22,11,"Buffer"],[54,20,22,17],[54,21,22,17,"Buffer"],[54,27,22,17],[54,28,22,18,"from"],[54,32,22,22],[54,33,22,23,"randomBytes"],[54,44,22,34],[54,45,22,35],[54,46,22,36,"toString"],[54,54,22,44],[54,55,22,45],[54,60,22,50],[54,61,22,51],[55,4,23,2],[55,5,23,3],[55,6,23,4],[55,13,23,11,"error"],[55,18,23,16],[55,20,23,18],[56,6,24,4],[57,6,25,4],[57,12,25,10,"array"],[57,17,25,15],[57,20,25,18],[57,24,25,22,"Uint8Array"],[57,34,25,32],[57,35,25,33,"size"],[57,39,25,37],[57,40,25,38],[58,6,26,4],[58,10,26,8],[58,17,26,15,"crypto"],[58,23,26,21],[58,28,26,26],[58,39,26,37],[58,43,26,41,"crypto"],[58,49,26,47],[58,50,26,48,"getRandomValues"],[58,65,26,63],[58,67,26,65],[59,8,27,6,"crypto"],[59,14,27,12],[59,15,27,13,"getRandomValues"],[59,30,27,28],[59,31,27,29,"array"],[59,36,27,34],[59,37,27,35],[60,6,28,4],[60,7,28,5],[60,13,28,11],[61,8,29,6],[61,13,29,11],[61,17,29,15,"i"],[61,18,29,16],[61,21,29,19],[61,22,29,20],[61,24,29,22,"i"],[61,25,29,23],[61,28,29,26,"size"],[61,32,29,30],[61,34,29,32,"i"],[61,35,29,33],[61,37,29,35],[61,39,29,37],[62,10,30,8,"array"],[62,15,30,13],[62,16,30,14,"i"],[62,17,30,15],[62,18,30,16],[62,21,30,19,"Math"],[62,25,30,23],[62,26,30,24,"floor"],[62,31,30,29],[62,32,30,30,"Math"],[62,36,30,34],[62,37,30,35,"random"],[62,43,30,41],[62,44,30,42],[62,45,30,43],[62,48,30,46],[62,51,30,49],[62,52,30,50],[63,8,31,6],[64,6,32,4],[65,6,33,4],[65,13,33,11,"Buffer"],[65,20,33,17],[65,21,33,17,"Buffer"],[65,27,33,17],[65,28,33,18,"from"],[65,32,33,22],[65,33,33,23,"array"],[65,38,33,28],[65,39,33,29],[65,40,33,30,"toString"],[65,48,33,38],[65,49,33,39],[65,54,33,44],[65,55,33,45],[66,4,34,2],[67,2,35,0],[69,2,37,0],[70,0,38,0],[71,0,39,0],[72,0,40,0],[73,2,41,7],[73,11,41,16,"deriveMasterKey"],[73,26,41,31,"deriveMasterKey"],[73,27,41,32,"pin"],[73,30,41,43],[73,32,41,45,"salt"],[73,36,41,57],[73,38,41,67],[74,4,42,2],[74,10,42,8,"key"],[74,13,42,11],[74,16,42,14,"CryptoJS"],[74,24,42,22],[74,25,42,22,"default"],[74,32,42,22],[74,33,42,23,"PBKDF2"],[74,39,42,29],[74,40,42,30,"pin"],[74,43,42,33],[74,45,42,35,"CryptoJS"],[74,53,42,43],[74,54,42,43,"default"],[74,61,42,43],[74,62,42,44,"enc"],[74,65,42,47],[74,66,42,48,"Hex"],[74,69,42,51],[74,70,42,52,"parse"],[74,75,42,57],[74,76,42,58,"salt"],[74,80,42,62],[74,81,42,63],[74,83,42,65],[75,6,43,4,"keySize"],[75,13,43,11],[75,15,43,13,"KEY_SIZE"],[75,23,43,21],[76,6,44,4,"iterations"],[76,16,44,14],[76,18,44,16,"ITERATIONS"],[76,28,44,26],[77,6,45,4,"hasher"],[77,12,45,10],[77,14,45,12,"CryptoJS"],[77,22,45,20],[77,23,45,20,"default"],[77,30,45,20],[77,31,45,21,"algo"],[77,35,45,25],[77,36,45,26,"SHA256"],[78,4,46,2],[78,5,46,3],[78,6,46,4],[79,4,47,2],[79,11,47,9,"key"],[79,14,47,12],[79,15,47,13,"toString"],[79,23,47,21],[79,24,47,22,"CryptoJS"],[79,32,47,30],[79,33,47,30,"default"],[79,40,47,30],[79,41,47,31,"enc"],[79,44,47,34],[79,45,47,35,"Hex"],[79,48,47,38],[79,49,47,39],[80,2,48,0],[82,2,50,0],[83,0,51,0],[84,0,52,0],[85,2,53,7],[85,17,53,22,"generateSalt"],[85,29,53,34,"generateSalt"],[85,30,53,34],[85,32,53,54],[86,4,54,2],[86,11,54,9,"generateRandomBytes"],[86,30,54,28],[86,31,54,29,"SALT_SIZE"],[86,40,54,38],[86,41,54,39],[87,2,55,0],[89,2,57,0],[90,0,58,0],[91,0,59,0],[92,2,60,7],[92,17,60,22,"generateFEK"],[92,28,60,33,"generateFEK"],[92,29,60,33],[92,31,60,53],[93,4,61,2],[93,11,61,9,"generateRandomBytes"],[93,30,61,28],[93,31,61,29],[93,33,61,31],[93,34,61,32],[93,35,61,33],[93,36,61,34],[94,2,62,0],[96,2,64,0],[97,0,65,0],[98,0,66,0],[99,2,67,7],[99,17,67,22,"generateIV"],[99,27,67,32,"generateIV"],[99,28,67,32],[99,30,67,52],[100,4,68,2],[100,11,68,9,"generateRandomBytes"],[100,30,68,28],[100,31,68,29],[100,33,68,31],[100,34,68,32],[100,35,68,33],[100,36,68,34],[101,2,69,0],[102,0,69,1],[102,3]],"functionMap":{"names":["<global>","generateRandomBytes","deriveMasterKey","generateSalt","generateFEK","generateIV"],"mappings":"AAA;OCkB;CDgB;OEM;CFO;OGK;CHE;OIK;CJE;OKK;CLE"},"hasCjsExports":false},"type":"js/module"}]}